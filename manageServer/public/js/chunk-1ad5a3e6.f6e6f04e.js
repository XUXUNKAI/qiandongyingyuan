(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ad5a3e6"],{"0227":function(e,t,a){},"159b":function(e,t,a){var o=a("da84"),r=a("fdbc"),i=a("17c2"),l=a("9112");for(var s in r){var m=o[s],n=m&&m.prototype;if(n&&n.forEach!==i)try{l(n,"forEach",i)}catch(c){n.forEach=i}}},"17c2":function(e,t,a){"use strict";var o=a("b727").forEach,r=a("a640"),i=a("ae40"),l=r("forEach"),s=i("forEach");e.exports=l&&s?[].forEach:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}},"3b3a":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"release"},[a("el-form",{ref:"form",staticClass:"form-box",attrs:{model:e.movieData,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影名称",prop:"name"}},[a("el-input",{attrs:{readonly:1==e.flag},model:{value:e.movieData.movie.name,callback:function(t){e.$set(e.movieData.movie,"name",t)},expression:"movieData.movie.name"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影英文名称",prop:"enname"}},[a("el-input",{attrs:{readonly:1==e.flag},model:{value:e.movieData.movie.enname,callback:function(t){e.$set(e.movieData.movie,"enname",t)},expression:"movieData.movie.enname"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影简介",prop:"desc"}},[a("el-input",{attrs:{resize:"none",autosize:{minRows:3,maxRows:6},type:"textarea",readonly:1==e.flag},model:{value:e.movieData.movie.desc,callback:function(t){e.$set(e.movieData.movie,"desc",t)},expression:"movieData.movie.desc"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影类型",prop:"type"}},[a("el-input",{attrs:{readonly:1==e.flag},model:{value:e.movieData.movie.type,callback:function(t){e.$set(e.movieData.movie,"type",t)},expression:"movieData.movie.type"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影时长",prop:"duration"}},[a("el-input",{attrs:{readonly:1==e.flag},model:{value:e.movieData.movie.duration,callback:function(t){e.$set(e.movieData.movie,"duration",t)},expression:"movieData.movie.duration"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"上映日期",prop:"date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",disabled:1==e.flag},model:{value:e.movieData.movie.date,callback:function(t){e.$set(e.movieData.movie,"date",t)},expression:"movieData.movie.date"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影模式",prop:"mode"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择电影模式",disabled:1==e.flag},model:{value:e.movieData.movie.mode,callback:function(t){e.$set(e.movieData.movie,"mode",t)},expression:"movieData.movie.mode"}},[a("el-option",{attrs:{label:"2D",value:"2D"}},[e._v("2D")]),a("el-option",{attrs:{label:"3D",value:"3D"}},[e._v("3D")])],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影状态",prop:"mode"}},[a("el-radio-group",{attrs:{disabled:1==e.flag},model:{value:e.movieData.movie.status,callback:function(t){e.$set(e.movieData.movie,"status",t)},expression:"movieData.movie.status"}},[a("el-radio",{attrs:{label:"上架"}}),a("el-radio",{attrs:{label:"下架"}})],1)],1)],1)],1),a("div",[e._l(e.movieData.moveImages,(function(t,o){return a("el-row",{key:o},[a("el-col",{attrs:{span:10}},[a("el-form-item",{class:{mb0:o==e.movieData.moveImages.length-1},attrs:{label:"电影封面"+(o+1),prop:"url"}},[a("el-row",[a("el-col",{attrs:{span:15}},[a("KamoUpload",{attrs:{types:e.types,disabled:1==e.flag},on:{"upload-file":function(a){return e.upload(a,t)}}},[a("img",{staticClass:"kamo-img",attrs:{src:t.url,alt:""}})])],1),e.movieData.moveImages.length>1?a("el-col",{attrs:{span:7}},[1!=e.flag?a("div",{staticClass:"delete el-icon-remove-outline release-delete",on:{click:function(a){return e.removeCover(t.coverId,o,t)}}}):e._e()]):e._e()],1)],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:""}},[a("div",{staticClass:"add-box"},[1!=e.flag?a("div",{staticClass:"delete el-icon-circle-plus-outline add",on:{click:function(t){return e.addItem("moveImages",{type:"",url:""},"url","请先上传该图片")}}}):e._e()])])],1)],1)],2),a("div",[e._l(e.movieData.director,(function(t,o){return a("el-row",{key:o},[a("el-col",{attrs:{span:10}},[a("el-form-item",{class:{mb0:o==e.movieData.director.length-1},attrs:{label:"电影导演"+(o+1),prop:"name"}},[a("el-input",{attrs:{readonly:1==e.flag},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1)],1),e.movieData.director.length>1?a("el-col",{attrs:{span:14}},[1!=e.flag?a("div",{staticClass:"delete el-icon-remove-outline",on:{click:function(a){return e.removeDirector(t.directorId,o)}}}):e._e()]):e._e()],1)})),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:""}},[1!=e.flag?a("div",{staticClass:"delete el-icon-circle-plus-outline add",on:{click:function(t){return e.addItem("director",{name:""},"name","请填写导演名称")}}}):e._e()])],1)],1)],2),a("div",[e._l(e.movieData.performer,(function(t,o){return a("div",{key:o},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"电影演员"+(o+1),prop:"name"}},[a("el-input",{attrs:{readonly:1==e.flag},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1)],1),a("el-col",{staticClass:"zhuyan",attrs:{span:2}},[a("el-checkbox",{attrs:{border:!0,disabled:1==e.flag},model:{value:t.role,callback:function(a){e.$set(t,"role",a)},expression:"item.role"}},[e._v("主演")])],1),e.movieData.performer.length>1?a("el-col",{attrs:{span:4}},[1!=e.flag?a("div",{staticClass:"delete el-icon-remove-outline",on:{click:function(a){return e.removePerformer(t.performerId,o,t)}}}):e._e()]):e._e()],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:""}},[a("KamoUpload",{attrs:{types:e.types,disabled:1==e.flag},on:{"upload-file":function(a){return e.upload(a,t)}}},[a("img",{staticClass:"kamo-img",attrs:{src:t.url,alt:""}})])],1)],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:""}},[a("div",{staticClass:"add-box"},[1!=e.flag?a("div",{staticClass:"delete el-icon-circle-plus-outline add",on:{click:function(t){return e.addItem("performer",{name:"",url:"",role:!1,type:""},"name","请填写演员名称")}}}):e._e()])])],1)],1)],2),1!=e.flag?a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:e.sendMovie}},[e._v("发布")])],1)],1)],1):e._e()],1)],1)},r=[],i=(a("4160"),a("a434"),a("b0c0"),a("159b"),a("6031")),l=a("79c4"),s={name:"ReleaseMovie",data:function(){return{flag:0,movieId:"",types:["png","jpg","jpeg","webp","gif"],movieData:{movie:{name:"",enname:"",desc:"",type:"",duration:"",date:"",mode:"",status:"上架"},moveImages:[{url:"",type:""}],director:[{name:""}],performer:[{name:"",role:!1,url:"",type:""}]}}},created:function(){var e=this.$route.query;this.flag=e.flag||0,this.movieId=e.movieId,0!=this.flag&&this.movieList(this.movieId)},methods:{addItem:function(e,t,a,o){var r=this.movieData[e][this.movieData[e].length-1];""!=r[a]?this.movieData[e].push(t):this.$message({message:o,duration:2e3,type:"error"})},upload:function(e,t){t.url=e.base64,t.type=e.type},sendMovie:function(){var e={name:{msg:"电影名称不能空且不能含有<>"},enname:{msg:"电影英文名称不能空且不能含有<>"},desc:{msg:"电影简介不能空且不能含有<>"},type:{msg:"电影类型不能空且不能含有<>"},duration:{msg:"电影时长不能空且不能含有<>"},date:{msg:"上映日期不能空且不能含有<>"},mode:{msg:"电影模式不能空且不能含有<>"}};for(var t in e){var a=this.movieData.movie[t];if(""==a||/[<>]/.test(a))return void this.$message({message:e[t].msg,duration:2e3,type:"error"})}var o={moveImages:{msg:"电影封面不能为空",k:"url"},director:{msg:"电影导演不能为空且不能含有<>",k:"name"},performer:{msg:"电影演员不能为空且不能含有<>",k:"name"}};for(var r in o)if(!this.valid(r,o[r].k,o[r].msg))return;var i=Object.assign({},this.movieData);for(var s in i.movie.date=l["a"].formatDate(new Date(i.movie.date),"yyyy-MM-dd"),2==this.flag&&(i.movie.movieId=this.movieId),i)i[s]=JSON.stringify(i[s]);2==this.flag&&(i.flag=2),this.axios({method:"POST",url:"/releaseMovie",data:i}).then((function(e){})).catch((function(e){}))},valid:function(e,t,a){for(var o=0;o<this.movieData[e].length;o++){if(""==this.movieData[e][o][t]||"name"==t&&/[<>]/.test(this.movieData[e][o][t]))return this.$message({message:a,duration:2e3,type:"error"}),!1;if("performer"==e&&""==this.movieData[e][o].url)return this.$message({message:"电影演员图片不能为空",duration:2e3,type:"error"}),!1}return!0},movieList:function(e){var t=this;this.axios({method:"GET",url:"/movieList",params:{movieId:e}}).then((function(e){var a=e.data.result[0];for(var o in a.date=new Date(a.date),t.movieData.movie)t.movieData.movie[o]=a[o];if(e.data.result.forEach((function(e,a){if(0==e.mc_isremove){var o=!1;if(0==a)t.movieData.moveImages[0].url=e.coverImg,t.movieData.moveImages[0].type="",t.movieData.moveImages[0].coverId=e.cover_id,t.movieData.moveImages[0].isRemove=e.mc_isremove;else{for(var r=0;r<t.movieData.moveImages.length;r++)if(t.movieData.moveImages[r].url==e.coverImg){o=!0;break}o||t.movieData.moveImages.push({url:e.coverImg,type:"",coverId:e.cover_id,isRemove:e.mc_isremove})}}else 0==a&&t.movieData.moveImages.pop()})),0==t.movieData.moveImages.length){e.data.result[0];t.movieData.moveImages.push({url:"",type:""})}if(e.data.result.forEach((function(e,a){if(0==e.d_isremove){var o=!1;if(0==a)t.movieData.director[0].name=e.director,t.movieData.director[0].directorId=e.director_id,t.movieData.director[0].isRemove=e.d_isremove;else{for(var r=0;r<t.movieData.director.length;r++)if(t.movieData.director[r].name==e.director){o=!0;break}o||t.movieData.director.push({name:e.director,directorId:e.director_id,isRemove:e.d_isremove})}}else 0==a&&t.movieData.director.pop()})),0==t.movieData.director.length){e.data.result[0];t.movieData.director.push({name:""})}if(e.data.result.forEach((function(e,a){if(0==e.p_isremove){var o=!1;if(0==a)t.movieData.performer[0].name=e.performerName,t.movieData.performer[0].url=e.perfermerImg,t.movieData.performer[0].role=1==e.role,t.movieData.performer[0].type="",t.movieData.performer[0].performerId=e.performer_id,t.movieData.performer[0].isRemove=e.p_isremove;else{for(var r=0;r<t.movieData.performer.length;r++)if(t.movieData.performer[r].name==e.performerName){o=!0;break}o||t.movieData.performer.push({name:e.performerName,url:e.perfermerImg,role:1==e.role,type:"",performerId:e.performer_id,isRemove:e.p_isremove})}}else 0==a&&t.movieData.performer.pop()})),0==t.movieData.performer.length){e.data.result[0];t.movieData.performer.push({url:"",type:""})}})).catch((function(e){}))},removeCover:function(e,t,a){var o=this;void 0==e||e&&""==a.type?this.movieData.moveImages.splice(t,1):this.axios({method:"POST",url:"/removeCover",data:{id:e}}).then((function(e){o.movieData.moveImages.splice(t,1)})).catch((function(e){}))},removeDirector:function(e,t){var a=this;void 0!==e?this.axios({method:"POST",url:"/removeDirector",data:{id:e}}).then((function(e){a.movieData.director.splice(t,1)})).catch((function(e){})):this.movieData.director.splice(t,1)},removePerformer:function(e,t,a){var o=this;this.axios({method:"POST",url:"/removePerformer",data:{id:e}}).then((function(e){o.movieData.performer.splice(t,1)})).catch((function(e){}))}},components:{KamoUpload:i["a"]}},m=s,n=(a("f235"),a("2877")),c=Object(n["a"])(m,o,r,!1,null,"605ac418",null);t["default"]=c.exports},4160:function(e,t,a){"use strict";var o=a("23e7"),r=a("17c2");o({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},"65f0":function(e,t,a){var o=a("861d"),r=a("e8b5"),i=a("b622"),l=i("species");e.exports=function(e,t){var a;return r(e)&&(a=e.constructor,"function"!=typeof a||a!==Array&&!r(a.prototype)?o(a)&&(a=a[l],null===a&&(a=void 0)):a=void 0),new(void 0===a?Array:a)(0===t?0:t)}},a434:function(e,t,a){"use strict";var o=a("23e7"),r=a("23cb"),i=a("a691"),l=a("50c4"),s=a("7b0b"),m=a("65f0"),n=a("8418"),c=a("1dde"),v=a("ae40"),d=c("splice"),f=v("splice",{ACCESSORS:!0,0:0,1:2}),u=Math.max,p=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!d||!f},{splice:function(e,t){var a,o,c,v,d,f,D=s(this),b=l(D.length),y=r(e,b),I=arguments.length;if(0===I?a=o=0:1===I?(a=0,o=b-y):(a=I-2,o=p(u(i(t),0),b-y)),b+a-o>h)throw TypeError(g);for(c=m(D,o),v=0;v<o;v++)d=y+v,d in D&&n(c,v,D[d]);if(c.length=o,a<o){for(v=y;v<b-o;v++)d=v+o,f=v+a,d in D?D[f]=D[d]:delete D[f];for(v=b;v>b-o+a;v--)delete D[v-1]}else if(a>o)for(v=b-o;v>y;v--)d=v+o-1,f=v+a-1,d in D?D[f]=D[d]:delete D[f];for(v=0;v<a;v++)D[v+y]=arguments[v+2];return D.length=b-o+a,c}})},b0c0:function(e,t,a){var o=a("83ab"),r=a("9bf2").f,i=Function.prototype,l=i.toString,s=/^\s*function ([^ (]*)/,m="name";o&&!(m in i)&&r(i,m,{configurable:!0,get:function(){try{return l.call(this).match(s)[1]}catch(e){return""}}})},b727:function(e,t,a){var o=a("0366"),r=a("44ad"),i=a("7b0b"),l=a("50c4"),s=a("65f0"),m=[].push,n=function(e){var t=1==e,a=2==e,n=3==e,c=4==e,v=6==e,d=5==e||v;return function(f,u,p,h){for(var g,D,b=i(f),y=r(b),I=o(u,p,3),k=l(y.length),w=0,x=h||s,_=t?x(f,k):a?x(f,0):void 0;k>w;w++)if((d||w in y)&&(g=y[w],D=I(g,w,b),e))if(t)_[w]=D;else if(D)switch(e){case 3:return!0;case 5:return g;case 6:return w;case 2:m.call(_,g)}else if(c)return!1;return v?-1:n||c?c:_}};e.exports={forEach:n(0),map:n(1),filter:n(2),some:n(3),every:n(4),find:n(5),findIndex:n(6)}},f235:function(e,t,a){"use strict";var o=a("0227"),r=a.n(o);r.a},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-1ad5a3e6.f6e6f04e.js.map